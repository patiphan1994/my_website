<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3DNP | SALES & RECEIPT SYSTEM</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <style>
        /* --- üåë ‡∏•‡πá‡∏≠‡∏Ñ‡∏ò‡∏µ‡∏° Titanium & Apple Minimal & ‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏≤‡∏Å‡∏Ñ‡∏•‡∏∏‡∏° --- */
        body { 
            margin: 0; padding: 0; font-family: 'Prompt', sans-serif; min-height: 100vh; 
            background: #000; color: white; display: flex; justify-content: center; align-items: center;
            -webkit-user-select: none; user-select: none; /* ‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏≤‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏≥‡∏ï‡∏≤‡∏°‡∏™‡∏±‡πà‡∏á */
        }

        /* --- üîí ‡∏´‡∏ô‡πâ‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ Admin --- */
        #admin-lock {
            position: fixed; inset: 0; background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }

        .admin-panel {
            background: rgba(255,255,255,0.03); padding: 40px; border-radius: 30px; 
            width: 100%; max-width: 500px; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(20px);
            margin: 40px 0;
        }

        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #666; font-size: 0.85rem; padding-left: 15px; }
        
        input, select {
            width: 100%; padding: 15px; background: #111; border: 1px solid #333; 
            color: white; border-radius: 50px; font-size: 1rem; box-sizing: border-box; outline: none;
            -webkit-user-select: text; user-select: text; /* ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ */
        }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå Titanium */
        .btn-titanium {
            width: 100%; padding: 15px; border: none; border-radius: 50px; font-weight: 700;
            background: linear-gradient(to bottom, #7d828c 0%, #2e3338 100%); color: white;
            cursor: pointer; border-top: 1px solid rgba(255,255,255,0.3); box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: 0.3s; margin-top: 10px;
        }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏≤‡∏á‡∏•‡∏±‡∏î‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Blue Apple Style) */
        .btn-workspace {
            background: linear-gradient(to right, #0071e3, #4facfe);
            margin-top: 20px;
        }

        #status-log { margin-top: 20px; font-size: 0.85rem; text-align: center; color: #4facfe; line-height: 1.6; }

        /* üè† ‡∏õ‡∏∏‡πà‡∏° Home ‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô */
        .btn-home {
            position: fixed; top: 25px; right: 25px; width: 45px; height: 45px;
            background: linear-gradient(to bottom, #7d828c 0%, #2e3338 100%);
            border-radius: 50%; display: flex; justify-content: center; align-items: center; 
            color: white; text-decoration: none; border-top: 1px solid rgba(255,255,255,0.4);
        }
    </style>
</head>
<body>

    <div id="admin-lock">
        <div style="font-size: 3rem; color: #4facfe; margin-bottom: 20px;"><i class="fas fa-user-shield"></i></div>
        <h2 style="margin-bottom: 30px;">Admin Authorization</h2>
        <input type="password" id="masterPassword" placeholder="Enter Secret Password" style="width: 300px; text-align: center; margin-bottom: 20px;">
        <button class="btn-titanium" onclick="unlockAdmin()" style="width: 300px;">UNLOCK SYSTEM</button>
    </div>

    <a href="login.html" class="btn-home"><i class="fas fa-home"></i></a>

    <div class="admin-panel">
        <div style="font-size: 1.8rem; font-weight: 700; text-align: center; margin-bottom: 30px;">3DNP <span>SALES TOOL</span></div>
        
        <div class="input-group">
            <label>CUSTOMER EMAIL (‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</label>
            <input type="email" id="custEmail" placeholder="customer@email.com">
        </div>

        <div class="input-group">
            <label>LICENSE PLAN (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô)</label>
            <select id="keyType">
                <option value="MONTHLY">Monthly Plan (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô - 590 THB)</option>
                <option value="YEARLY">Yearly Plan (‡∏£‡∏≤‡∏¢‡∏õ‡∏µ - 5,900 THB)</option>
                <option value="VIP">Lifetime VIP (‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û - 15,000 THB)</option>
            </select>
        </div>

        <button class="btn-titanium" onclick="processSale()">‚ö° GEN KEY & SEND RECEIPT</button>
        
        <button class="btn-titanium btn-workspace" onclick="window.location.href='system.html'">
            <i class="fas fa-desktop"></i> GO TO WORKSPACE
        </button>

        <div id="status-log"></div>
    </div>

    <script>
        // 1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô EmailJS (‡∏•‡∏π‡∏Å‡∏û‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏≠‡∏≤ Public Key ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö)
        emailjs.init("YOUR_PUBLIC_KEY_HERE"); 

        function unlockAdmin() {
            const pass = document.getElementById('masterPassword').value;
            if(pass === "admin1234") { // ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                document.getElementById('admin-lock').style.display = 'none';
            } else { alert("‚ùå Access Denied!"); }
        }

        async function processSale() {
            const email = document.getElementById('custEmail').value;
            const plan = document.getElementById('keyType').value;
            const log = document.getElementById('status-log');

            if(!email) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö"); return; }

            // 2. ‡∏£‡∏∞‡∏ö‡∏ö Gen Key ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            const random = Math.random().toString(36).substring(2, 10).toUpperCase();
            const generatedKey = `3DNP-${plan}-${random.substring(0,4)}-${random.substring(4,8)}`;
            
            // 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à (Receipt ID & Price)
            const receiptID = "REC-" + Date.now().toString().slice(-6);
            let price = "590 THB";
            if(plan === "YEARLY") price = "5,900 THB";
            if(plan === "VIP") price = "15,000 THB";

            log.innerHTML = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏à‡∏≤‡∏Å np_1994@3dnpcons.com...";

            // 4. ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•‡∏ú‡πà‡∏≤‡∏ô EmailJS
            emailjs.send("service_0oj1gyf", "YOUR_TEMPLATE_ID_HERE", {
                from_name: "3DNP CONSTRUCTION",
                reply_to: "np_1994@3dnpcons.com", // ‡πÄ‡∏°‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ
                to_email: email,
                key: generatedKey,
                plan: plan,
                receipt_id: receiptID,
                price: price,
                date: new Date().toLocaleDateString()
            }).then(function() {
                log.innerHTML = `<span style="color:#2ed573;">‚úÖ ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!</span><br><b>Key:</b> ${generatedKey}<br><b>Receipt:</b> ${receiptID}`;
                alert("SUCCESS!\n‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏µ‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÑ‡∏õ‡∏ó‡∏µ‡πà " + email + " ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö");
            }, function(error) {
                log.innerHTML = `<span style="color:#ff4757;">‚ùå ‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${JSON.stringify(error)}</span>`;
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÄ‡∏°‡∏•!");
            });
        }
    </script>
</body>
</html>
